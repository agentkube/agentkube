// types/scanner/vulnerability-report.ts

// Existing types
export interface Vulnerability {
  vulnerabilityID: string;
  resource: string;
  installedVersion: string;
  fixedVersion: string;
  publishedDate: string;
  lastModifiedDate: string;
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW' | 'UNKNOWN' | 'NONE';
  title: string;
  primaryLink?: string;
  links: string[];
  score?: number;
  target: string;
  packagePURL: string;
}

export interface VulnerabilitySummary {
  critical: number;
  high: number;
  medium: number;
  low: number;
  unknown: number;
}

export interface OwnerReference {
  apiVersion: string;
  blockOwnerDeletion?: boolean;
  controller?: boolean;
  kind: string;
  name: string;
  uid: string;
}

export interface VulnerabilityReportMetadata {
  name: string;
  namespace: string;
  creationTimestamp: string;
  generation: number;
  resourceVersion: string;
  uid: string;
  annotations?: {
    [key: string]: string;
  };
  labels?: {
    [key: string]: string;
  };
  ownerReferences?: OwnerReference[];
}

export interface ArtifactInfo {
  repository: string;
  digest: string;
  tag: string;
}

export interface OSInfo {
  eosl: boolean;
  family: string;
  name: string;
}

export interface RegistryInfo {
  server: string;
}

export interface ScannerInfo {
  name: string;
  vendor: string;
  version: string;
}

export interface ReportSummary {
  criticalCount: number;
  highCount: number;
  lowCount: number;
  mediumCount: number;
  noneCount: number;
  unknownCount: number;
}

export interface ReportDetails {
  artifact: ArtifactInfo;
  os: OSInfo;
  registry: RegistryInfo;
  scanner: ScannerInfo;
  summary: ReportSummary;
  updateTimestamp: string;
  vulnerabilities: Vulnerability[];
}

export interface VulnerabilityReport {
  apiVersion: string;
  kind: string;
  metadata: VulnerabilityReportMetadata;
  report: ReportDetails;
}

export interface VulnerabilityReportItem {
  name: string;
  namespace: string;
  age: string;
  creationTimestamp: string;
  group: string;
  version: string;
  summary: VulnerabilitySummary;
  owner: {
    name: string;
    kind: string;
    apiVersion: string;
  };
}

export interface VulnerabilityReportResponse {
  metadata: string;
  items: VulnerabilityReport[];
}

export interface Summary {
  failCount: number;
  passCount: number;
}

export interface ClusterComplianceReport {
  name: string;
  group: string;
  version: string;
  creationTimestamp: string;
  summary: Summary;
}

export interface VulnerabilityReportsApiResponse {
  cluster: string;
  namespace: string;
  reports: VulnerabilityReportItem[];
}

export interface ComplianceReportsApiResponse {
  cluster: string;
  reports: ClusterComplianceReport[];
}

// Compliance check types
export interface ComplianceCheck {
  id: string;
  name: string;
  severity: string;
  totalFail: number;
}

export interface DetailedComplianceReport {
  status: {
    summaryReport: {
      controlCheck: ComplianceCheck[];
    };
  };
}